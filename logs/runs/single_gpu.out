START TIME: Mon May 19 16:02:27 CEST 2025
Job Name: lsai
Job ID: 450255
Allocated Node(s): nid006494
Number of Tasks: 1
CPUs per Task: 72
GPUs per Node: 1
Number of Nodes: : 1
Number of Tasks per Node: 1
Current path: /workspaces
Current user: aoudrhiri
execute command on compute nodes
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
[srun] rank=0 host=nid006494 noderank=0 localrank=0
2025-05-19 16:02:47,758 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=5e-05, lr_warmup_steps=10, training_steps=10, logging_frequency=1, profile=False, profile_step_start=10, profile_step_end=10, grad_max_norm=1, model_dtype='bf16', compile=False, experiment='test', user='aoudrhiri', tensor_parallel=False)
2025-05-19 16:02:47,758 - root - INFO - Setting up DataLoaders...
2025-05-19 16:02:50,526 - root - INFO - Setting up Model...
2025-05-19 16:03:24,794 - root - INFO - Starting training!
2025-05-19 16:03:25,567 - root - INFO - LOGITS: tensor([[[-0.7930, -0.9102,  0.6602,  ..., -1.9844, -0.6133,  0.8281],
         [-0.0605, -0.3574,  0.8086,  ..., -0.9922, -0.4414,  0.5000],
         [-0.5195, -0.1807,  0.5625,  ..., -1.6953, -0.4570,  0.5234],
         ...,
         [ 1.4922,  1.1797,  0.3984,  ...,  1.1875, -0.4961, -0.6328],
         [ 1.5078,  1.1797,  0.4043,  ...,  1.1953, -0.5039, -0.6133],
         [ 1.5078,  1.1797,  0.3945,  ...,  1.1875, -0.5039, -0.6211]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:25,958 - root - INFO - Step: 1 | Loss: 11.93 | Tokens per second: 1823.22 | Training tokens per second (%): 38.77 | MFU (%): 8.91 | TFLOPs: 88.10
2025-05-19 16:03:26,034 - root - INFO - LOGITS: tensor([[[-0.8438, -0.9180,  0.6875,  ..., -1.9531, -0.5820,  0.8125],
         [-0.5195, -1.2656,  0.9922,  ..., -1.4688, -1.1250,  1.1406],
         [-0.3242, -0.5039,  0.9922,  ..., -1.9219, -0.5703,  1.0078],
         ...,
         [ 1.3672,  1.2656,  0.4570,  ...,  0.7031, -0.4902, -0.1094],
         [ 1.3750,  1.2656,  0.4512,  ...,  0.6992, -0.5000, -0.1108],
         [ 1.3750,  1.2656,  0.4453,  ...,  0.7031, -0.4883, -0.1108]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:26,276 - root - INFO - Step: 2 | Loss: 11.88 | Tokens per second: 7380.67 | Training tokens per second (%): 10.60 | MFU (%): 36.06 | TFLOPs: 356.63
2025-05-19 16:03:26,349 - root - INFO - LOGITS: tensor([[[-0.9531, -1.0156,  0.7305,  ..., -1.8672, -0.4082,  0.8359],
         [-0.6289, -0.2451,  0.6719,  ..., -1.0156,  0.3594,  0.9609],
         [-0.1396, -0.6523,  0.2520,  ..., -0.3535,  0.2676,  0.5391],
         ...,
         [ 1.1953,  1.1719,  0.3750,  ...,  0.7148, -0.5312, -0.0859],
         [ 1.1953,  1.1719,  0.3730,  ...,  0.7188, -0.5273, -0.0815],
         [ 1.1797,  1.1719,  0.3770,  ...,  0.7109, -0.5312, -0.0854]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:26,588 - root - INFO - Step: 3 | Loss: 11.79 | Tokens per second: 7564.18 | Training tokens per second (%): 3.52 | MFU (%): 36.96 | TFLOPs: 365.50
2025-05-19 16:03:26,749 - root - INFO - LOGITS: tensor([[[-0.8828, -1.0312,  0.6914,  ..., -1.8125, -0.1768,  0.8867],
         [-1.2578, -0.6797,  1.0547,  ..., -0.9961,  0.3438,  1.2500],
         [-0.4883, -0.8750,  0.7070,  ..., -1.4141, -0.2295,  0.9219],
         ...,
         [ 1.3828,  1.1953,  0.3633,  ...,  0.7734, -0.3770, -0.4336],
         [ 1.3750,  1.1953,  0.3574,  ...,  0.7812, -0.3867, -0.4336],
         [ 1.3750,  1.1953,  0.3613,  ...,  0.7773, -0.3809, -0.4355]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:26,983 - root - INFO - Step: 4 | Loss: 11.51 | Tokens per second: 5626.49 | Training tokens per second (%): 16.16 | MFU (%): 27.49 | TFLOPs: 271.87
2025-05-19 16:03:27,064 - root - INFO - LOGITS: tensor([[[-0.9258, -1.1719,  0.6992,  ..., -1.5781,  0.1699,  0.8086],
         [-0.3613, -0.2324,  0.7773,  ..., -1.6250,  0.0459,  1.3281],
         [-0.2578, -0.2041,  1.0391,  ..., -1.2500,  0.3789,  0.3105],
         ...,
         [ 1.1875,  0.7734, -0.2598,  ...,  0.9414, -0.2793, -0.9883],
         [ 1.1875,  0.7773, -0.2598,  ...,  0.9414, -0.2734, -0.9961],
         [ 1.1953,  0.7656, -0.2559,  ...,  0.9414, -0.2871, -1.0000]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:27,316 - root - INFO - Step: 5 | Loss: 11.31 | Tokens per second: 7015.71 | Training tokens per second (%): 61.04 | MFU (%): 34.28 | TFLOPs: 339.00
2025-05-19 16:03:27,394 - root - INFO - LOGITS: tensor([[[-0.9727, -1.2109,  0.7227,  ..., -1.2422,  0.4883,  0.6562],
         [-0.1836, -0.8438,  0.1973,  ..., -0.1069,  0.4785,  0.9062],
         [ 0.1226, -0.9141,  0.8633,  ..., -0.2275,  0.5469,  0.6562],
         ...,
         [ 1.2969,  0.8867, -0.1206,  ...,  1.1562, -0.1099, -0.6484],
         [ 1.2969,  0.8906, -0.1191,  ...,  1.1562, -0.1108, -0.6445],
         [ 1.2969,  0.8945, -0.1133,  ...,  1.1484, -0.1099, -0.6406]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:27,641 - root - INFO - Step: 6 | Loss: 10.74 | Tokens per second: 7212.83 | Training tokens per second (%): 45.26 | MFU (%): 35.24 | TFLOPs: 348.52
2025-05-19 16:03:27,717 - root - INFO - LOGITS: tensor([[[-1.0703, -1.2656,  0.7656,  ..., -0.9492,  0.5469,  0.5156],
         [-0.4961, -0.6992,  1.0234,  ..., -0.5703,  0.9648,  0.8281],
         [-0.6562, -0.4766,  0.8164,  ..., -0.2734,  0.8828,  0.6328],
         ...,
         [ 1.1875,  1.0234,  0.1914,  ...,  0.8906, -0.2949, -0.4727],
         [ 1.1875,  1.0312,  0.1855,  ...,  0.8906, -0.2949, -0.4727],
         [ 1.1875,  1.0312,  0.1865,  ...,  0.8945, -0.2910, -0.4746]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:27,960 - root - INFO - Step: 7 | Loss: 10.71 | Tokens per second: 7346.62 | Training tokens per second (%): 17.72 | MFU (%): 35.89 | TFLOPs: 354.99
2025-05-19 16:03:28,039 - root - INFO - LOGITS: tensor([[[-1.0703, -1.2109,  0.8008,  ..., -0.7227,  0.6133,  0.3555],
         [-0.6875, -0.9023,  0.7695,  ..., -0.2969,  0.4219,  0.1934],
         [-0.8398, -0.7773,  0.4219,  ..., -0.4844,  0.6250,  0.1533],
         ...,
         [ 0.5508,  0.3242, -0.0923,  ...,  1.0078,  0.2539, -1.0156],
         [ 0.5469,  0.3340, -0.0903,  ...,  1.0078,  0.2578, -1.0234],
         [ 0.5469,  0.3457, -0.0977,  ...,  1.0156,  0.2637, -1.0156]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:28,293 - root - INFO - Step: 8 | Loss: 10.10 | Tokens per second: 7021.31 | Training tokens per second (%): 63.04 | MFU (%): 34.30 | TFLOPs: 339.27
2025-05-19 16:03:28,373 - root - INFO - LOGITS: tensor([[[-1.1172, -1.1875,  0.7578,  ..., -0.5742,  0.6523,  0.1226],
         [-0.7383, -1.2344,  0.9727,  ..., -0.0415,  0.9062, -0.2158],
         [-0.9570, -0.9922,  0.3125,  ..., -0.3516,  0.9961, -0.1543],
         ...,
         [ 0.0182, -0.2500,  0.0767,  ...,  0.6016,  0.4805, -0.9609],
         [ 0.0181, -0.2559,  0.0806,  ...,  0.6016,  0.4863, -0.9648],
         [ 0.0248, -0.2520,  0.0767,  ...,  0.5977,  0.4844, -0.9648]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:28,630 - root - INFO - Step: 9 | Loss: 10.16 | Tokens per second: 6904.24 | Training tokens per second (%): 84.72 | MFU (%): 33.73 | TFLOPs: 333.61
2025-05-19 16:03:28,708 - root - INFO - LOGITS: tensor([[[-1.1562, -1.2031,  0.6641,  ..., -0.4512,  0.5469, -0.0942],
         [-0.9258, -0.7031,  0.7656,  ..., -0.0117,  0.6992, -0.3477],
         [-0.9883, -0.9609,  0.2324,  ..., -0.2354,  0.8203, -0.1553],
         ...,
         [ 0.1816,  0.1299,  0.1162,  ...,  0.9883,  0.2354, -1.2422],
         [ 0.1904,  0.1309,  0.1177,  ...,  0.9844,  0.2295, -1.2344],
         [ 0.1797,  0.1299,  0.1128,  ...,  0.9844,  0.2236, -1.2344]]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<UnsafeViewBackward0>)
2025-05-19 16:03:28,955 - root - INFO - Step: 10 | Loss: 10.35 | Tokens per second: 7216.93 | Training tokens per second (%): 46.44 | MFU (%): 35.26 | TFLOPs: 348.72
2025-05-19 16:03:28,955 - root - INFO - Training completed
END TIME: Mon May 19 16:03:31 CEST 2025
